<div class="card">
  <div class="card-header d-flex justify-content-between align-items-center">
    <h3 class="fs-4">Review Management</h3>
    <!-- Optionally, you can add a button or search bar here -->
  </div>

  <div class="card-body">
    <div *ngIf="isLoading" class="text-muted">Loading reviews...</div>
    <div *ngIf="error" class="text-danger">{{ error }}</div>

    <div class="table-responsive table-bordered" *ngIf="!isLoading && reviews.length">
      <table class="table table-striped table-hover">
        <thead class="table-dark">
          <tr>
            <th>#</th>
            <th>Name</th>
            <th>Mobile</th>
            <th>Product</th>
            <th>Rating</th>
            <th>Comment</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let review of reviews; let i = index">
            <td>{{ offset + i + 1 }}</td>
            <td>{{ review.user_id?.name || "N/A" }}</td>
            <td>{{ review.user_id?.mobile || "N/A" }}</td>
            <td>{{ review.product_id?.name || "N/A" }}</td>
            <td>{{ review.rating }}</td>
            <td>
              {{ review.comment | slice : 0 : 30 }}
              <span *ngIf="review.comment.length > 30">...</span>
            </td>
            <td>
              <a class="btn btn-sm btn-outline-primary primaryout" [routerLink]="['/admin/reviews', review._id]" data-bs-toggle="tooltip"
                data-bs-placement="top" title="View">
                <i class="fas fa-eye fs-6"></i>
              </a>

              <button class="btn btn-sm btn-outline-danger ms-2" (click)="review._id && deleteReview(review._id)"
                type="button">
                 <i class="cil-trash"></i>
              </button>

            </td>
          </tr>
        </tbody>
      </table>

      <!-- Pagination Controls -->
      <nav *ngIf="totalPages > 1" aria-label="Review pagination">
        <ul class="pagination justify-content-end">
          <li class="page-item" [class.disabled]="currentPage === 1 || isLoading" (click)="prevPage()">
            <a class="page-link" href="javascript:void(0)">Previous</a>
          </li>

          <li class="page-item" *ngFor="let page of [].constructor(totalPages); let idx = index"
            [class.active]="currentPage === idx + 1" (click)="goToPage(idx + 1)">
            <a class="page-link" href="javascript:void(0)">{{ idx + 1 }}</a>
          </li>

          <li class="page-item" [class.disabled]="currentPage === totalPages || isLoading" (click)="nextPage()">
            <a class="page-link" href="javascript:void(0)">Next</a>
          </li>
        </ul>
      </nav>
    </div>

    <div *ngIf="!isLoading && reviews.length === 0" class="text-center text-muted">
      No reviews found.
    </div>
  </div>
</div>

<!-- Review Detail Section -->
<!-- <div *ngIf="selectedReview" class="card mt-4">
  <div class="card-header">
    <h4>Review Details</h4>
  </div>
  <div class="card-body">
    <p><strong>Customer Name:</strong> {{ selectedReview.user_id?.name || "N/A" }}</p>
    <p><strong>Mobile:</strong> {{ selectedReview.user_id?.mobile || "N/A" }}</p>
    <p><strong>Product:</strong> {{ selectedReview.product_id?.name || "N/A" }}</p>
    <p><strong>Rating:</strong> {{ selectedReview.rating }}</p>
    <p><strong>Comment:</strong> {{ selectedReview.comment }}</p>
    <p>
      <strong>Status:</strong>
      <span
        class="badge"
        [ngClass]="{
          'bg-success': selectedReview.status === 'active',
          'bg-danger': selectedReview.status === 'inactive'
        }"
      >
        {{ selectedReview.status || "N/A" }}
      </span>
    </p>
  </div>
</div> -->