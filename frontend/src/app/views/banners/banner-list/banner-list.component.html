<!-- banner-list.component.html -->
<div class="card">
  <div class="card-header d-flex justify-content-between align-items-center">
    <h3>Banner Management</h3>
  </div>
  <div class="card-body">
    <div class="mb-3 d-flex justify-content-between align-items-center">
      <input
        type="text"
        [(ngModel)]="searchTerm"
        (input)="onSearchChange()"
        class="form-control w-25"
        placeholder="Search by title"
      />
      <button class="btn btn-primary primary" routerLink="/admin/banners/add">
        Add New Banner
      </button>
    </div>

    <div class="table-responsive table-bordered text-center">
      <table class="table table-striped table-hover mb-0">
        <thead>
          <tr>
            <th>#</th>
            <th>Title</th>
            <th>Type</th>
            <th>Content</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let banner of banners; let i = index">
            <td>{{ (currentPage - 1) * limit + i + 1 }}</td>
            <td>{{ banner.title }}</td>
            <td>{{ bannerTypeMap[banner.banner_type] || banner.banner_type }}</td>

            <td>
              <ng-container *ngIf="banner.image; else showVideo">
                <img
                  [src]="banner.image"
                  alt="Banner Image"
                  class="img-thumbnail"
                  style="height: 50px; width: 100px;"
                />
              </ng-container>
              <ng-template #showVideo>
                <video
                  *ngIf="banner.video"
                  [src]="banner.video"
                  style="height: 50px; width: 100px;"
                  controls
                ></video>
              </ng-template>
            </td>

            <td>
              <span
                class="badge"
                [ngClass]="{
                  'bg-success': banner.status === 'active',
                  'bg-danger': banner.status === 'inactive'
                }"
              >
                {{ banner.status | titlecase }}
              </span>
            </td>

            <td>
              <div class="btn-group" role="group">
                <button
                  class="btn btn-sm btn-outline-primary primaryout"
                  [routerLink]="['/admin/banners/view', banner._id]"
                  data-bs-toggle="tooltip"
                  data-bs-placement="top"
                  title="View"
                >
                  <i class="far fa-eye fs-6"></i>
                </button>

                <button
                  class="btn btn-sm btn-outline-warning"
                  [routerLink]="['/admin/banners/edit', banner._id]"
                  data-bs-toggle="tooltip"
                  data-bs-placement="top"
                  title="Edit"
                >
                  <i class="cil-pencil"></i>
                </button>

                <button
                  class="btn btn-sm btn-outline-secondary"
                  (click)="toggleStatus(banner)"
                  data-bs-toggle="tooltip"
                  data-bs-placement="top"
                  title="Toggle Status"
                >
                  <i class="cil-sync"></i>
                </button>

                <button
                  class="btn btn-sm btn-outline-danger"
                  (click)="deleteBanner(banner._id!)"
                  data-bs-toggle="tooltip"
                  data-bs-placement="top"
                  title="Delete"
                >
                  <i class="cil-trash"></i>
                </button>
              </div>
            </td>
          </tr>

          <tr *ngIf="banners.length === 0 && !isLoading">
            <td colspan="6" class="text-center">No banners found</td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Pagination Controls -->
    <nav *ngIf="totalPages > 1" class="mt-3">
      <ul class="pagination justify-content-center mb-0">
        <li class="page-item" [class.disabled]="currentPage === 1">
          <button
            class="page-link"
            (click)="changePage(currentPage - 1)"
            [disabled]="currentPage === 1"
          >
            Previous
          </button>
        </li>

        <li
          class="page-item"
          *ngFor="let _ of [].constructor(totalPages); let idx = index"
          [class.active]="currentPage === idx + 1"
        >
          <button class="page-link" (click)="changePage(idx + 1)">
            {{ idx + 1 }}
          </button>
        </li>

        <li class="page-item" [class.disabled]="currentPage === totalPages">
          <button
            class="page-link"
            (click)="changePage(currentPage + 1)"
            [disabled]="currentPage === totalPages"
          >
            Next
          </button>
        </li>
      </ul>
    </nav>
  </div>
</div>
