<div *ngIf="!loading && request as r; else loadingTemplate">
  <h2>Return Request Details</h2>

  <div class="card p-3">
    <p><strong>User:</strong> {{ r.user_id?.name || '-' }} ({{ r.user_id?.mobile || '-' }})</p>
    <p><strong>Seller:</strong> {{ r.seller_id?.shop_name || '-' }} ({{ r.seller_id?.mobile || '-' }})</p>
    <p><strong>Order:</strong> Order #{{ r.order_id?.order_id || '-' }} - â‚¹{{ r.order_id?.total_price || '-' }}</p>
    <p><strong>Reason:</strong> {{ r.reason || '-' }}</p>
    <p><strong>Description:</strong> {{ r.description || '-' }}</p>
    <p><strong>Status:</strong> 
      <span class="text-muted">{{ r.status }}</span>
    </p>

    <p *ngIf="r.admin_response"><strong>Admin Response:</strong> {{ r.admin_response }}</p>

    <!-- Proof Images -->
    <div *ngIf="r.proof_images?.length" class="mt-3">
      <h5>Proof Images:</h5>
      <div class="d-flex flex-wrap gap-2">
        <img *ngFor="let img of r.proof_images" [src]="img" class="border p-1" style="width:150px; height:auto;" />
      </div>
    </div>

    <!-- Admin Response Input + Action Buttons -->
    <div *ngIf="r.status !== 'Returned'" class="mt-4">
      <label for="adminResponse" class="form-label">Admin Response</label>
      <textarea id="adminResponse" class="form-control mb-2" rows="3" [(ngModel)]="adminResponse" [disabled]="saving"></textarea>

      <div class="mt-2">
        <button class="btn btn-success me-2" (click)="updateStatus('Approved')" [disabled]="saving">Approve</button>
        <button class="btn btn-danger me-2" (click)="updateStatus('Denied')" [disabled]="saving">Deny</button>
        <button class="btn btn-secondary" (click)="updateStatus('Returned')" [disabled]="saving">Mark as Returned</button>
      </div>
    </div>
  </div>
</div>

<ng-template #loadingTemplate>
  <div class="alert alert-info">Loading return request...</div>
</ng-template>
